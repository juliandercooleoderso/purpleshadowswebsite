<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Purple Shadows Gang</title>
<script src="/socket.io/socket.io.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<style>
/* === Global === */
body {
  margin:0; padding:0;
  font-family:"Poppins",sans-serif;
  background: radial-gradient(circle at top left, #2b0030, #000);
  color:#fff;
  overflow-x:hidden;
}

/* Header */
header {
  background:#3b0066;
  padding:15px;
  font-size:1.8rem;
  font-weight:bold;
  letter-spacing:2px;
  position:relative;
  display:flex;
  justify-content:center;
  align-items:center;
}
#logged-in { position:absolute; right:20px; top:15px; font-size:1rem; color:#fff; }

/* Animated logo right */
#logo-right {
  position:absolute;
  top:10px;
  right:100px;
  width:120px;
  animation: floatLogo 4s ease-in-out infinite;
  filter: drop-shadow(0 0 25px #9b00ff);
}

/* Navigation */
nav { margin:15px; text-align:center; }
nav button {
  background:#5a00a3; color:white;
  border:none; padding:10px 20px; margin:5px;
  border-radius:12px; cursor:pointer; transition:0.3s;
}
nav button:hover { background:#9b00ff; }

/* Sections */
section { display:none; margin-top:20px; position:relative; }
section.active { display:block; }

/* Tables */
table { width:90%; margin:20px auto; border-collapse:collapse; background: rgba(60,0,90,0.5); border-radius:12px; overflow:hidden; }
th, td { border:1px solid #7d2aff; padding:12px 15px; text-align:center; }
th { background:#5a00a3; }
button.fancy-member { background: #5a00a3; color: white; border: none; padding: 5px 10px; border-radius: 8px; cursor: pointer; transition: 0.3s; }
button.fancy-member:hover { background:#9b00ff; }

/* Blur Cards */
.blur-card { backdrop-filter: blur(10px); background: rgba(60,0,90,0.5); border-radius:20px; padding:20px; box-shadow: 0 0 30px #7d2aff; display:flex; flex-direction:column; align-items:center; transition: transform 0.3s, box-shadow 0.3s; }
.blur-card:hover { transform: translateY(-5px); box-shadow:0 0 50px #d18eff; }
.blur-card img { border-radius:12px; margin-bottom:10px; max-width:180px; }

/* Auto Popup */
#auto-popup { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.85); justify-content:center; align-items:center; z-index:20; }
#auto-popup-content { background:#2b0030; padding:25px; border-radius:20px; width:300px; text-align:left; box-shadow:0 0 30px #9b00ff; }

/* Logo Animation */
.logo-float { animation: floatLogo 4s ease-in-out infinite; filter: drop-shadow(0 0 25px #9b00ff); display:block; margin:25px auto; width:220px; }
@keyframes floatLogo { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }

#viewer { position:absolute; top:20px; left:20px; font-size:1.1rem; text-shadow:0 0 8px #fff; }

/* Login Modal */
#login-container{
  position:fixed; top:0; left:0; width:100%; height:100%;
  background: rgba(0,0,0,0.95);
  display:flex; justify-content:center; align-items:center; z-index:100;
}
#login-box{
  background:#2b0030; padding:30px; border-radius:20px;
  width:300px; box-shadow:0 0 20px #7d2aff; text-align:center;
}
#login-box input,#login-box button{ display:block; width:100%; margin:10px 0; padding:10px; border-radius:8px; border:none; }
button.fancy { background:linear-gradient(90deg,#7d2aff,#d18eff); border:none; color:#fff; padding:8px 15px; border-radius:10px; cursor:pointer; transition:0.3s; }
button.fancy:hover { background:linear-gradient(90deg,#d18eff,#7d2aff); }
</style>
</head>
<body>
<header>
üíú Purple Shadows üíú
<img id="logo-right" src="https://cdn.discordapp.com/attachments/1231233950089744504/1425925001311293602/Lila_Schatten_Logo-removebg-preview.png?ex=68eb55e4&is=68ea0464&hm=fc01da8317a10f2dca042c9a317b94acd7b2b03007cac8a61380d85e1057cf0b&">
<div id="logged-in"></div>
</header>

<nav>
  <button onclick="showTab('home')">Startseite</button>
  <button onclick="showTab('shop')">Shop</button>
  <button onclick="showTab('members')">Mitgliederliste</button>
  <button onclick="showTab('autoliste')">Autoliste</button>
  <button id="stats-btn" onclick="showTab('stats')" style="display:none;">Statistiken</button>
</nav>

<div id="viewer">üëÅÔ∏è 0</div>

<!-- Sections (home, shop, autoliste, members, stats) hier ... √§hnlich wie vorher, alles mit blur-cards, animiertem Logo, Auto Popup etc. -->

<!-- Login Modal -->
<div id="login-container">
  <div id="login-box">
    <h2>Login</h2>
    <input id="login-username" placeholder="Username">
    <input id="login-password" type="password" placeholder="Passwort">
    <button onclick="login()">Login</button>
    <p id="login-error" style="color:red;"></p>
  </div>
</div>

<script>
const socket = io();
let currentUser = null;
const allowedUsers = ["Julian","Max"];

// Tabs
function showTab(id){
  document.querySelectorAll("section").forEach(s => s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

// Socket Events
socket.on("updateViewers", count => {
  document.getElementById("viewer").innerText = `üëÅÔ∏è ${count}`;
  const homeCount = document.getElementById("home-online-count");
  if(homeCount) homeCount.innerText = count;
});
socket.on("updateMembers", members => {
  const memberCountElem = document.getElementById("home-member-count");
  if(memberCountElem) memberCountElem.innerText = members.length;
});
socket.on("updateOnlineUsers", users => {
  const box = document.getElementById("online-users-box");
  if(!box) return;
  box.innerHTML = "";
  if(users.length===0){ box.innerHTML="<p style='opacity:0.6;'>Niemand online</p>"; return; }
  users.forEach(u => { const p=document.createElement("p"); p.textContent="‚Ä¢ "+u; box.appendChild(p); });
});
socket.on("newAuditLog", log => {
  const box = document.getElementById("audit-log-box");
  if(!box) return;
  if(box.querySelector("p") && box.querySelector("p").style.opacity==="0.6") box.innerHTML="";
  const time = new Date().toLocaleTimeString();
  const p = document.createElement("p");
  p.textContent = `[${time}] ${log}`;
  box.appendChild(p);
  box.scrollTop = box.scrollHeight;
});

// Login
async function login(){
  const username = document.getElementById("login-username").value.trim();
  const password = document.getElementById("login-password").value.trim();
  if(!username||!password){document.getElementById("login-error").innerText="Bitte ausf√ºllen!";return;}
  try{
    const res = await axios.post("/login",{username,password});
    if(res.data.success){
      currentUser=username;
      document.getElementById("login-container").style.display="none";
      document.getElementById("logged-in").innerText=`Eingeloggt als: ${username}`;
      socket.emit("userOnline", username);
      if(allowedUsers.includes(username)) document.getElementById("stats-btn").style.display="inline-block";
    } else{
      document.getElementById("login-error").innerText=res.data.message || "Login fehlgeschlagen!";
    }
  } catch(e){
    document.getElementById("login-error").innerText="Serverfehler!";
    console.error(e);
  }
}
</script>
</body>
</html>
