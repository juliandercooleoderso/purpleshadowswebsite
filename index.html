<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Purple Shadows</title>
    <script src="/socket.io/socket.io.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: "Poppins", sans-serif;
            background: radial-gradient(circle at top left, #2b0030, #000);
            color: #fff;
            text-align: center;
        }

        /* Header */
        header {
            background: #3b0066;
            padding: 15px;
            font-size: 1.8rem;
            font-weight: bold;
            letter-spacing: 2px;
            position: relative;
        }

        #logged-in {
            position: absolute;
            right: 20px;
            top: 15px;
            font-size: 1rem;
            color: #fff;
        }

        /* Navigation */
        nav {
            margin: 15px;
        }

        nav button {
            background: #5a00a3;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 12px;
            cursor: pointer;
            transition: 0.3s;
        }

        nav button:hover {
            background: #9b00ff;
        }

        /* Sections */
        section {
            display: none;
            margin-top: 20px;
            position: relative;
        }

        section.active {
            display: block;
        }

        /* Tables */
        table {
            width: 90%;
            margin: 20px auto;
            border-collapse: collapse;
            background: rgba(60, 0, 90, 0.5);
            border-radius: 12px;
            overflow: hidden;
        }

        th,
        td {
            border: 1px solid #7d2aff;
            padding: 12px 15px;
            text-align: center;
        }

        th {
            background: #5a00a3;
        }

        select,
        input {
            background: #3b0066;
            color: #fff;
            border: 1px solid #7d2aff;
            border-radius: 8px;
            padding: 8px;
            box-sizing: border-box;
        }

        button.fancy {
            background: linear-gradient(90deg, #7d2aff, #d18eff);
            border: none;
            color: #fff;
            padding: 8px 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: 0.3s;
        }

        button.fancy:hover {
            background: linear-gradient(90deg, #d18eff, #7d2aff);
        }

        /* Blur Cards */
        .blur-card {
            backdrop-filter: blur(10px);
            background: rgba(60, 0, 90, 0.5);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 0 30px #7d2aff;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .blur-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 50px #d18eff;
        }

        .blur-card img {
            border-radius: 12px;
            margin-bottom: 10px;
            max-width: 180px;
        }

        /* Auto Popup */
        #auto-popup {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            justify-content: center;
            align-items: center;
            z-index: 20;
        }

        #auto-popup-content {
            background: #2b0030;
            padding: 25px;
            border-radius: 20px;
            width: 300px;
            text-align: left;
            box-shadow: 0 0 30px #9b00ff;
        }

        #auto-popup-content h3 {
            text-align: center;
            margin-bottom: 15px;
        }

        /* Logo Animation */
        .logo-float {
            animation: floatLogo 4s ease-in-out infinite;
            filter: drop-shadow(0 0 25px #9b00ff);
            display: block;
            margin: 25px auto;
            width: 220px;
        }

        @keyframes floatLogo {
            0%,
            100% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        #viewer {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 1.1rem;
            text-shadow: 0 0 8px #fff;
        }

        /* ===================== LOGIN ===================== */
        #login-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }

        #login-box {
            background: #2b0030;
            padding: 30px;
            border-radius: 20px;
            width: 300px;
            box-shadow: 0 0 20px #7d2aff;
            text-align: center;
        }

        #login-box input,
        #login-box button {
            display: block;
            width: 100%;
            margin: 10px 0;
            padding: 10px;
            border-radius: 8px;
            border: none;
        }
    </style>
</head>
<body>
    <header>
        üíú Purple Shadows üíú
        <div id="logged-in"></div>
    </header>

    <nav>
        <button onclick="showTab('home')">Startseite</button>
        <button onclick="showTab('shop')">Shop</button>
        <button onclick="showTab('members')">Mitgliederliste</button>
        <button onclick="showTab('autoliste')">Autoliste</button>
        <button id="stats-btn" onclick="showTab('stats')" style="display:none;">Statistiken</button>
    </nav>

    <div id="viewer">üëÅÔ∏è 0</div>

    <!-- Home Section -->
    <section id="home" class="active">
        <h2>üíú Willkommen bei Purple Shadows üíú</h2>
        <img class="logo-float" src="https://cdn.discordapp.com/attachments/1231233950089744504/1425925001311293602/Lila_Schatten_Logo-removebg-preview.png">
    </section>

    <!-- Shop Section -->
    <section id="shop">
        <h2>üíú Purple Shadows - Shop üíú</h2>
        <img class="logo-float" src="https://cdn.discordapp.com/attachments/1231233950089744504/1425925001311293602/Lila_Schatten_Logo-removebg-preview.png">
        <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:25px;padding:20px;">
            <!-- Shop Items hier (kann √§hnlich wie im Original hinzugef√ºgt werden) -->
        </div>
    </section>

    <!-- Autoliste Section -->
    <section id="autoliste">
        <h2>üíú Purple Shadows - Autoliste üíú</h2>
        <img class="logo-float" src="https://cdn.discordapp.com/attachments/1231233950089744504/1425925001311293602/Lila_Schatten_Logo-removebg-preview.png">
        <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:25px; padding:20px;">
            <!-- Autos hier (kann √§hnlich wie im Original hinzugef√ºgt werden) -->
        </div>
    </section>

    <!-- Mitgliederliste Section -->
    <section id="members">
        <h2>üíú Purple Shadows - Mitgliederliste üíú</h2>
        <img class="logo-float" src="https://cdn.discordapp.com/attachments/1231233950089744504/1425925001311293602/Lila_Schatten_Logo-removebg-preview.png">
        <table>
            <thead>
                <tr>
                    <th>Username</th>
                    <th>Rang</th>
                </tr>
            </thead>
            <tbody id="members-table"></tbody>
        </table>
    </section>

    <!-- Statistiken Section -->
    <section id="stats">
        <h2>üìä Statistiken</h2>
        <img class="logo-float" src="https://cdn.discordapp.com/attachments/1231233950089744504/1425925001311293602/Lila_Schatten_Logo-removebg-preview.png">
        <div style="display:flex; justify-content:center; flex-wrap:wrap; gap:50px; margin-top:40px;">
            <div class="blur-card" style="max-width:400px;">
                <h3>üìú Audit Logs</h3>
                <div id="audit-log-box" style="max-height:300px; overflow-y:auto; text-align:left; background:rgba(0,0,0,0.3); padding:10px; border-radius:10px;">
                    <p style="opacity:0.6;">Noch keine Logs...</p>
                </div>
            </div>
            <div class="blur-card" style="max-width:400px;">
                <h3>üü¢ Online User</h3>
                <div id="online-users-box" style="max-height:300px; overflow-y:auto; text-align:left; background:rgba(0,0,0,0.3); padding:10px; border-radius:10px;">
                    <p style="opacity:0.6;">Niemand online</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Auto Popup -->
    <div id="auto-popup">
        <div id="auto-popup-content">
            <h3 id="auto-popup-name">Auto Name</h3>
            <p id="auto-popup-preis">Preis: </p>
            <p id="auto-popup-primary">Primary Farbe: </p>
            <p id="auto-popup-interior">Interieur Farbe: </p>
            <p id="auto-popup-wheels">Felgen Farbe: </p>
            <p id="auto-popup-undercarriage">Unterboden: </p>
            <p id="auto-popup-rank">Rang: </p>
            <button class="fancy" onclick="closeAutoPopup()">Close</button>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="login-container">
        <div id="login-box">
            <h2>Login</h2>
            <input id="login-username" placeholder="Username">
            <input id="login-password" type="password" placeholder="Passwort">
            <button onclick="login()">Login</button>
            <p id="login-error" style="color:red;"></p>
        </div>
    </div>

    <script>
        const socket = io();
        let currentUser = null;
        const allowedUsers = ["Julian","Max"];

        function showTab(id) {
            document.querySelectorAll("section").forEach(s => s.classList.remove("active"));
            document.getElementById(id).classList.add("active");
        }

        function renderMembers(members) {
            const table = document.getElementById("members-table");
            table.innerHTML = "";
            members.forEach(m => {
                const row = document.createElement("tr");
                row.innerHTML = `<td>${m.username}</td><td>${m.rank}</td>`;
                table.appendChild(row);
            });
        }

        socket.on("updateMembers", members => renderMembers(members));
        socket.on("updateViewers", count => document.getElementById("viewer").innerText = `üëÅÔ∏è ${count}`);
        socket.on("updateOnlineUsers", users => {
            const box = document.getElementById("online-users-box");
            box.innerHTML = "";
            if(users.length===0){
                box.innerHTML = "<p style='opacity:0.6;'>Niemand online</p>";
                return;
            }
            users.forEach(u => {
                const p = document.createElement("p");
                p.textContent = "‚Ä¢ " + u;
                box.appendChild(p);
            });
        });

        socket.on("newAuditLog", log => {
            const box = document.getElementById("audit-log-box");
            if(box.querySelector("p") && box.querySelector("p").style.opacity==="0.6") box.innerHTML="";
            const time = new Date().toLocaleTimeString();
            const p = document.createElement("p");
            p.textContent = `[${time}] ${log}`;
            box.appendChild(p);
            box.scrollTop = box.scrollHeight;
        });

        async function login(){
            const username = document.getElementById("login-username").value.trim();
            const password = document.getElementById("login-password").value.trim();
            if(username===""||password===""){
                document.getElementById("login-error").innerText="Bitte ausf√ºllen!";
                return;
            }
            try{
                const res = await axios.post("/login",{username,password});
                if(res.data.success){
                    currentUser = username;
                    document.getElementById("login-container").style.display="none";
                    document.getElementById("logged-in").innerText = `Eingeloggt als: ${username}`;
                    socket.emit("userOnline", username);
                    if(allowedUsers.includes(username)){
                        document.getElementById("stats-btn").style.display="inline-block";
                    }
                } else {
                    document.getElementById("login-error").innerText="Login fehlgeschlagen!";
                }
            } catch(e){
                document.getElementById("login-error").innerText="Serverfehler!";
            }
        }

        function openAutoPopup(name, preis, primary, interior, wheels, undercarriage, rank){
            document.getElementById("auto-popup-name").innerText = name;
            document.getElementById("auto-popup-preis").innerText = "Preis: " + preis;
            document.getElementById("auto-popup-primary").innerText = "Primary Farbe: " + primary;
            document.getElementById("auto-popup-interior").innerText = "Interieur Farbe: " + interior;
            document.getElementById("auto-popup-wheels").innerText = "Felgen Farbe: " + wheels;
            document.getElementById("auto-popup-undercarriage").innerText = "Unterboden: " + undercarriage;
            document.getElementById("auto-popup-rank").innerText = "Rang: " + rank;
            document.getElementById("auto-popup").style.display="flex";
        }

        function closeAutoPopup(){
            document.getElementById("auto-popup").style.display="none";
        }
    </script>
</body>
</html>

